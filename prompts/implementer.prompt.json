{
  "guide_id": "IMPL-GUIDE",
  "version": "1.0.3",
  "role": "Implementer",
  "ack": {
    "required": true,
    "start_with": "ACK IMPL-GUIDE v<x.y.z> (loaded)"
  },
  "output": {
    "envelope": {
      "type": "per-file",
      "begin": "BEGIN_FILE:",
      "end": "END_FILE",
      "require_filename": true,
      "require_filepath": true
    },
    "sections": [
      "PREFLIGHT",
      "CHANGED/ADDED FILES",
      "BUILD_NOTES",
      "CHANGELOG"
    ],
    "prefight_required": true
  },
  "preflight": [
    "Read tsconfig*.json and detect path aliases. Use ONLY configured aliases: @api/*, @components/*, @features/*, @store/*, @utils/*.",
    "List export shapes for modules you will touch (default or named) and DO NOT flip shapes unless you update ALL usages in this patch.",
    "Reuse-first: scan codebase for existing components/constants/styles and reuse/extend them; do not duplicate.",
    "Style audit: ensure JSX className ↔ CSS Modules selector match; prefer CSS tokens via var(--*); list unused selectors/tokens to remove."
  ],
  "constraints": [
    "Operate in the CURRENT workspace (no scaffolding).",
    "Respect aliases from tsconfig*.json (no \"@/\" if not configured).",
    "Preserve export shapes (no default↔named flips) unless all usages are updated in the same patch.",
    "Do not change public API shapes; add adapters if needed.",
    "CSS Modules only; import styles as ./*.module.css.",
    "TypeScript strict; no any; no !important (except SVG); SPA has no Helmet."
  ],
  "tasks": [
    "Implement catalog UL/LI semantics; a11y (aria-busy, visible focus).",
    "Wire self-host fonts: preload + font-display: swap.",
    "TanStack Query v5: strict price, dedup, auto-load to limit; keep keys as in architecture.",
    "SPA: <Seo/>; Next: generateMetadata.",
    "Lazy CSS by route/feature.",
    "Housekeeping: remove dead exports/unused CSS; keep exports/aliases consistent.",
    "If structure changes, update .dev/.ops/* (ARCHITECTURE, FILE_TREE, DECISIONS, BUILD_NOTES, CHANGELOG, BACKLOG)."
  ],
  "acceptance": [
    "No TS errors for imports/exports.",
    "Aliases used exactly as configured; no \"@/\".",
    "RQ keys: ['cars', filters, page/limit], ['car', id], ['brands']; strict price; dedup; auto-load-to-limit.",
    "Catalog uses ul[role=\"list\"] > li; a11y passes manual check.",
    "Fonts are self-hosted with preload+swap.",
    "SEO: <Seo/> for SPA or generateMetadata for Next.",
    "If changed structure, SoT updated."
  ],
  "style": {
    "full_files_only": true,
    "allow_why_comment": true
  },
  "guardrails": [
    "Always analyze the CURRENT codebase before creating anything.",
    "Never duplicate existing components/constants/styles; reuse-first.",
    "Never route all outputs to a single file; one envelope per file.",
    "If uncertain, include a short PREFLIGHT with findings and assumptions."
  ]
}
